# apparmor profile for cupspykota
# thomas@linuxmuster.net
# 04.02.2013
#

#include <tunables/global>

/usr/lib/cups/backend/cupspykota {
  #include <abstractions/apache2-common>
  #include <abstractions/base>

  capability chown,
  capability dac_override,
  capability setgid,
  capability setuid,

  /etc/pykota/* r,
  /etc/cups/cups-pdf.conf r,
  @{HOME}/PDF/ rw,
  @{HOME}/PDF/* rw,
  /proc/*/mounts r,
  /usr/bin/env ix,
  /usr/bin/python2.7 ix,
  /usr/include/python2.7/** mr,
  /usr/lib/cups/backend/* rix,
  /usr/lib/python2.7/** mr,
  /usr/share/pykota/* rix,
  /usr/share/pyshared/** r,
  /var/log/cups/cups-pdf_log w,
  /var/spool/cups-pdf/** w,
  /var/spool/cups/** rw,
}
